<?xml version="1.0" encoding="UTF-8"?>

<COMPONENT>
	<HEADER PLATEFORM="ALL" SERIAL="" VERSION="1.1" STATUS="PROD"
		COMPATIBILITY="ALL" AUTHOR="Jan Lolling" RELEASE_DATE="20141222A"
		STARTABLE="true" HAS_CONDITIONAL_OUTPUTS="true">
		<SIGNATURE />
	</HEADER>

	<FAMILIES>
		<FAMILY>Cloud/Google</FAMILY>
	</FAMILIES>

	<DOCUMENTATION>
		<URL />
	</DOCUMENTATION>

	<CONNECTORS>
		<CONNECTOR 
			NAME="FILES" 
			CTYPE="FLOW" 
			MAX_INPUT="0"
			MIN_OUTPUT="0" 
			MAX_OUTPUT="1" 
			LINE_STYLE="1" 
			SHOW_IF="(MODE == 'DOWNLOAD') or (MODE == 'DELETE') or (MODE == 'PROPERTIES') or (MODE == 'LIST') or (MODE == 'UPLOAD')" />
		<CONNECTOR CTYPE="ITERATE" MAX_INPUT="1" MAX_OUTPUT="1" />
		<CONNECTOR CTYPE="SUBJOB_OK" MAX_INPUT="1" MAX_OUTPUT="1" />
		<CONNECTOR CTYPE="SUBJOB_ERROR" MAX_INPUT="1" MAX_OUTPUT="1" />
		<CONNECTOR CTYPE="COMPONENT_OK" />
		<CONNECTOR CTYPE="COMPONENT_ERROR" />
		<CONNECTOR CTYPE="RUN_IF" />
	</CONNECTORS>
	<PARAMETERS>
		<PARAMETER FIELD="CLOSED_LIST" NAME="MODE" NUM_ROW="1" REQUIRED="true" >
	    	<ITEMS DEFAULT="CLIENT">
	    		<ITEM NAME="CLIENT" VALUE="CLIENT" />
	    		<ITEM NAME="LIST" VALUE="LIST" />
	    		<ITEM NAME="PROPERTIES" VALUE="PROPERTIES" />
	    		<ITEM NAME="UPLOAD" VALUE="UPLOAD" />
	    		<ITEM NAME="DOWNLOAD" VALUE="DOWNLOAD" />
	    		<ITEM NAME="DELETE" VALUE="DELETE" />
	    	</ITEMS>
		</PARAMETER>
		<PARAMETER 
			FIELD="CHECK" 
			NAME="USE_EXISTING_CLIENT" 
			NUM_ROW="5" 
			GROUP="CLIENT" SHOW_IF="(MODE == 'DOWNLOAD') or (MODE == 'DELETE') or (MODE == 'PROPERTIES') or (MODE == 'LIST') or (MODE == 'UPLOAD')" >
			<DEFAULT>false</DEFAULT>
		</PARAMETER>
    	<PARAMETER
	      	NAME="CLIENT"
	      	GROUP="CLIENT" 
	      	FIELD="COMPONENT_LIST"
	      	FILTER="tGoogleDrive"
	      	NUM_ROW="5" 
	      	REQUIRED="true"
	      	SHOW_IF="USE_EXISTING_CLIENT == 'true'"
    	/>
		<PARAMETER 
			FIELD="TEXT" 
			NAME="APPLICATION_NAME" 
			NUM_ROW="10" 
			SHOW_IF="USE_EXISTING_CLIENT == 'false'"
			GROUP="CLIENT">
			<DEFAULT>"GoogleDrive Talend Job"</DEFAULT>
		</PARAMETER>
		<PARAMETER 
			FIELD="CLOSED_LIST" 
			NAME="AUTHENTICATION_METHOD" 
			NUM_ROW="15" 
			REQUIRED="true" 
			GROUP="CLIENT" 
			SHOW_IF="USE_EXISTING_CLIENT == 'false'">
	    	<ITEMS DEFAULT="SERVICE_ACCOUNT">
	    		<ITEM NAME="SERVICE_ACCOUNT" VALUE="SERVICE_ACCOUNT" />
	    		<ITEM NAME="APPLICATION_CLIENT_ID" VALUE="APPLICATION_CLIENT_ID" />
	    	</ITEMS>
		</PARAMETER>
		<PARAMETER 
			FIELD="TEXT" 
			NAME="SERVICE_ACCOUNT_EMAIL" 
			NUM_ROW="20" 
			REQUIRED="true" 
			GROUP="CLIENT" 
			SHOW_IF="(AUTHENTICATION_METHOD == 'SERVICE_ACCOUNT') and (USE_EXISTING_CLIENT == 'false')">
			<DEFAULT>"[service-account-id]developer.gserviceaccount.com"</DEFAULT>
		</PARAMETER>
		<PARAMETER 
			FIELD="FILE" 
			NAME="KEY_FILE" 
			NUM_ROW="21" 
			REQUIRED="true" 
			GROUP="CLIENT" 
			SHOW_IF="(AUTHENTICATION_METHOD == 'SERVICE_ACCOUNT') and (USE_EXISTING_CLIENT == 'false')">
			<DEFAULT>"/tmp/76548c6bc96518473d7e425e1415a14e495d34eb-privatekey.p12"</DEFAULT>
		</PARAMETER>
		<PARAMETER 
			FIELD="TEXT" 
			NAME="USER_ACCOUNT_EMAIL" 
			NUM_ROW="20" 
			REQUIRED="true" 
			GROUP="CLIENT" 
			SHOW_IF="(AUTHENTICATION_METHOD == 'APPLICATION_CLIENT_ID') and (USE_EXISTING_CLIENT == 'false')">
			<DEFAULT>"yourmail@gmail.com"</DEFAULT>
		</PARAMETER>
		<PARAMETER FIELD="FILE" NAME="CLIENT_SECRET_FILE" NUM_ROW="21" REQUIRED="true" GROUP="CLIENT" 
			SHOW_IF="(AUTHENTICATION_METHOD == 'APPLICATION_CLIENT_ID') and (USE_EXISTING_CLIENT == 'false')">
			<DEFAULT>"/tmp/client_secret.json"</DEFAULT>
		</PARAMETER>

		<PARAMETER 
			NAME="SCHEMA_FILES" 
			FIELD="SCHEMA_TYPE"
			REQUIRED="true" 
			NUM_ROW="40" 
			SHOW_IF="(MODE == 'DOWNLOAD') or (MODE == 'DELETE') or (MODE == 'PROPERTIES') or (MODE == 'LIST') or (MODE == 'UPLOAD')"
			CONTEXT="FILES"  >
			<TABLE READONLY="true">
				<COLUMN NAME="FILE_ID" TYPE="id_String" READONLY="true"
					CUSTOM="true" LENGTH="64" KEY="true" NULLABLE="false" COMMENT="ID of the file" />
				<COLUMN NAME="FILE_TITLE" TYPE="id_String" READONLY="true" COMMENT="Title of the file"
					CUSTOM="true" LENGTH="128" NULLABLE="true" />
				<COLUMN NAME="ORIGINAL_FILE_NAME" TYPE="id_String" READONLY="true" COMMENT="Original name of the uploaded file"
					CUSTOM="true" LENGTH="255" NULLABLE="true" />
				<COLUMN NAME="FILE_EXTENSION" TYPE="id_String" READONLY="true" COMMENT="File extension without the dot"
					CUSTOM="true" LENGTH="16" NULLABLE="true" />
				<COLUMN NAME="FILE_CREATED_AT" TYPE="id_Date" READONLY="true"
					CUSTOM="true" PATTERN="&quot;yyyy-MM-dd HH:mm:ss&quot;" LENGTH="22" NULLABLE="true"/>
				<COLUMN NAME="FILE_LAST_MODIFIED_AT" TYPE="id_Date" READONLY="true"
					CUSTOM="true" PATTERN="&quot;yyyy-MM-dd HH:mm:ss&quot;" LENGTH="22" NULLABLE="true"/>
				<COLUMN NAME="FILE_MIME_TYPE" TYPE="id_String" READONLY="true"
					CUSTOM="true" LENGTH="64" NULLABLE="true" COMMENT="Mime type of the file" />
				<COLUMN NAME="FILE_DOWNLOAD_URL" TYPE="id_String" READONLY="true" COMMENT="URL to download the file with the API"
					CUSTOM="true" LENGTH="255" NULLABLE="true" />
				<COLUMN NAME="FILE_WEB_CONTENT_LINK" TYPE="id_String" READONLY="true" COMMENT="URL for users to download the file"
					CUSTOM="true" LENGTH="255" NULLABLE="true" />
				<COLUMN NAME="FILE_SIZE" TYPE="id_Long" READONLY="true"
					CUSTOM="true" LENGTH="19" NULLABLE="true" COMMENT="File size in byte" />
				<COLUMN NAME="FILE_OWNERS" TYPE="id_String" READONLY="true"
					CUSTOM="true" LENGTH="255" NULLABLE="true" COMMENT="Pipe separated list of the own names"/>
				<COLUMN NAME="FILE_IS_FOLDER" TYPE="id_Boolean" READONLY="true"
					CUSTOM="true" NULLABLE="true" COMMENT="true if the file is a folder"/>
			</TABLE>
		</PARAMETER>

		<PARAMETER FIELD="TEXT" NAME="FILE_FILTER_REGEX" NUM_ROW="50" REQUIRED="false" GROUP="FILE" SHOW_IF="MODE == 'LIST'"/>

		<PARAMETER FIELD="CHECK" NAME="FILE_FILTER_REGEX_CASE_SENSITIVE" NUM_ROW="50" REQUIRED="false" GROUP="FILE" SHOW_IF="MODE == 'LIST'">
			<DEFAULT>false</DEFAULT>
		</PARAMETER>
		<PARAMETER FIELD="TEXT" NAME="Q_STRING" NUM_ROW="52" REQUIRED="false" GROUP="FILE" SHOW_IF="MODE == 'LIST'"/>
		<PARAMETER FIELD="TEXT" NAME="REMOTE_FILTER_TITLE_STARTSWITH" NUM_ROW="53" REQUIRED="false" GROUP="FILE" SHOW_IF="MODE == 'LIST'"/>
		<PARAMETER FIELD="TEXT" NAME="REMOTE_FILTER_FULLTEXT" NUM_ROW="54" REQUIRED="false" GROUP="FILE" SHOW_IF="MODE == 'LIST'"/>

		<PARAMETER FIELD="TEXT" NAME="REMOTE_FILTER_MODIFYIED_FROM" NUM_ROW="55" REQUIRED="false" GROUP="FILE" SHOW_IF="MODE == 'LIST'"/>
		<PARAMETER FIELD="TEXT" NAME="REMOTE_FILTER_MODIFYIED_UNTIL" NUM_ROW="56" REQUIRED="false" GROUP="FILE" SHOW_IF="MODE == 'LIST'"/>

		<PARAMETER FIELD="TEXT" NAME="REMOTE_SEARCH_PATH" NUM_ROW="57" REQUIRED="false" GROUP="FILE" SHOW_IF="MODE == 'LIST'"/>
		<PARAMETER FIELD="TEXT" NAME="OWNER_EMAIL" NUM_ROW="58" REQUIRED="false" GROUP="FILE" SHOW_IF="MODE == 'LIST'"/>
		<PARAMETER FIELD="CHECK" NAME="RETURN_FOLDERS_AS_WELL" NUM_ROW="59" REQUIRED="false" GROUP="FILE" SHOW_IF="MODE == 'LIST'"/>

		<PARAMETER FIELD="TEXT" NAME="FILE_ID" NUM_ROW="60" GROUP="FILE" SHOW_IF="(MODE == 'DOWNLOAD') or (MODE == 'DELETE') or (MODE == 'PROPERTIES')" />
		<PARAMETER FIELD="TEXT" NAME="DRIVE_FILE_PATH" NUM_ROW="61" GROUP="FILE" SHOW_IF="(MODE == 'DOWNLOAD') or (MODE == 'DELETE') or (MODE == 'PROPERTIES')" />

		<PARAMETER FIELD="CHECK" NAME="IGNORE_MISSING" NUM_ROW="63" REQUIRED="true" GROUP="FILE" SHOW_IF="MODE == 'DELETE'"/>

		<PARAMETER FIELD="TEXT" NAME="FILE_TITLE" NUM_ROW="65" REQUIRED="false" GROUP="FILE" SHOW_IF="MODE == 'UPLOAD'"/>
		<PARAMETER FIELD="TEXT" NAME="REMOTE_PATH" NUM_ROW="66" GROUP="FILE" SHOW_IF="MODE == 'UPLOAD'"/>
		<PARAMETER FIELD="CHECK" NAME="CREATE_REMOTE_PATH" NUM_ROW="66" REQUIRED="true" GROUP="FILE" SHOW_IF="MODE == 'UPLOAD'"/>

		<PARAMETER FIELD="FILE" NAME="LOCAL_FILE_TO_UPLOAD" NUM_ROW="70" REQUIRED="true" GROUP="FILE" SHOW_IF="MODE == 'UPLOAD'"/>
		<PARAMETER FIELD="TEXT" NAME="LOCAL_TARGET_FOLDER" NUM_ROW="70" REQUIRED="true" GROUP="FILE" SHOW_IF="MODE == 'DOWNLOAD'"/>
		<PARAMETER FIELD="TEXT" NAME="LOCAL_TARGET_FILENAME" NUM_ROW="71" GROUP="FILE" SHOW_IF="MODE == 'DOWNLOAD'"/>
		
		<PARAMETER FIELD="CHECK" NAME="CREATE_LOCAL_DIR_IF_NOT_EXISTS" NUM_ROW="72" REQUIRED="true" GROUP="FILE" SHOW_IF="MODE == 'DOWNLOAD'"/>
		<PARAMETER FIELD="CHECK" NAME="OVERWRITE" NUM_ROW="74" REQUIRED="true" GROUP="FILE" SHOW_IF="MODE == 'UPLOAD'"/>
		<PARAMETER FIELD="CHECK" NAME="REMOVE_FROM_LOCAL_FS" NUM_ROW="74" REQUIRED="true" GROUP="FILE" SHOW_IF="MODE == 'UPLOAD'"/>
		<PARAMETER FIELD="CHECK" NAME="REMOVE_FROM_DRIVE" NUM_ROW="74" REQUIRED="true" GROUP="FILE" SHOW_IF="MODE == 'DOWNLOAD'"/>

	</PARAMETERS>
	<ADVANCED_PARAMETERS>
		<PARAMETER FIELD="TEXT" NAME="TIMEOUT_IN_SEC" NUM_ROW="10" >
			<DEFAULT>240</DEFAULT>
		</PARAMETER>
		<PARAMETER FIELD="TEXT" NAME="TIME_OFFSET" NUM_ROW="15" >
			<DEFAULT>10000</DEFAULT>
		</PARAMETER>
		<PARAMETER FIELD="CHECK" NAME="KEEP_CLIENT" NUM_ROW="40" >
			<DEFAULT>true</DEFAULT>
		</PARAMETER>
		<PARAMETER FIELD="TEXT" NAME="KEEP_CLIENT_KEY" NUM_ROW="40" 
		           SHOW_IF="KEEP_CLIENT == 'true'">
		</PARAMETER>
	</ADVANCED_PARAMETERS>
	<CODEGENERATION>
		<IMPORTS>
			<IMPORT NAME="Google Drive"
				MODULE="jlo.talendcomp.googledrive-1.1-jar-with-dependencies.jar"
				REQUIRED="true" />
		</IMPORTS>
	</CODEGENERATION>
	<RETURNS>
		<RETURN AVAILABILITY="AFTER" NAME="NB_LINE" TYPE="id_Integer" />
		<RETURN AVAILABILITY="AFTER" NAME="FILE_ID" TYPE="id_String" />
		<RETURN AVAILABILITY="AFTER" NAME="FILE_TITLE" TYPE="id_String" />
		<RETURN AVAILABILITY="AFTER" NAME="FILE_CREATED_AT" TYPE="id_Date" />
		<RETURN AVAILABILITY="AFTER" NAME="FILE_MODIFIED_AT" TYPE="id_Date" />
		<RETURN AVAILABILITY="AFTER" NAME="FILE_OWNERS" TYPE="id_String" />
		<RETURN AVAILABILITY="AFTER" NAME="FILE_SIZE" TYPE="id_Long" />
		<RETURN AVAILABILITY="AFTER" NAME="FILE_MIME_TYPE" TYPE="id_String" />
		<RETURN AVAILABILITY="AFTER" NAME="FILE_IS_FOLDER" TYPE="id_Boolean" />
		<RETURN AVAILABILITY="AFTER" NAME="FILE_EXISTS" TYPE="id_Boolean" />
		<RETURN AVAILABILITY="AFTER" NAME="DOWNLOADED_FILEPATH" TYPE="id_String" />
		<RETURN AVAILABILITY="AFTER" NAME="DOWNLOADED_FILESIZE" TYPE="id_Long" />
	</RETURNS>
</COMPONENT>
